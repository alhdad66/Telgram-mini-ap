<!DOCTYPE html>
<html lang="ar"> <!-- Changed lang to Arabic for better default accessibility -->
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="app_title">Premium Ad Reward System</title>
    
    <!-- Adsgram SDK -->
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    
    <!-- Telegram Mini Apps SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø²Ù… Firebase SDK Ù‡Ù†Ø§ØŒ ØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ ÙƒØªÙ„Ø© Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ÙˆØ­Ø¯Ø© ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¬Ø³Ù… -->

    <style>
        :root {
            /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø«Ø§Ù†ÙˆÙŠØ© ØªÙ… ØªØºÙŠÙŠØ±Ù‡Ø§ Ø¥Ù„Ù‰ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ø®Ø¶Ø± Ø§Ù„Ù†Ø§Ø¨Ø¶Ø© Ø¨Ø§Ù„Ø­ÙŠØ§Ø© */
            --primary: #00BF63; /* Ø£Ø®Ø¶Ø± Ù†Ø§Ø¨Ø¶ Ø¨Ø§Ù„Ø­ÙŠØ§Ø© */
            --primary-dark: #008C4A; /* Ø¯Ø±Ø¬Ø© Ø£ØºÙ…Ù‚ Ù„Ù„Ø¸Ù„Ø§Ù„ */
            --secondary: #32CD32; /* Ø£Ø®Ø¶Ø± Ù„ÙŠÙ…ÙˆÙ†ÙŠØŒ Ù„Ù„Ù…Ø³Ø© Ø£ÙƒØ«Ø± Ø­ÙŠÙˆÙŠØ© */
            --secondary-dark: #28A745; /* Ø¯Ø±Ø¬Ø© Ø£ØºÙ…Ù‚ Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ */
            
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f5f5f5;
            --gray: #2a2a2a;
            --card-bg: #1f1f1f;
            --gold: #ffd700;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker), #1a1a2e);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(0, 191, 99, 0.1) 0%, transparent 20%), /* Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
                radial-gradient(circle at 90% 80%, rgba(50, 205, 50, 0.1) 0%, transparent 20%); /* Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
            z-index: -1;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .header {
            /* ØªØ¯Ø±Ø¬ Ø§Ù„Ø±Ø£Ø³ Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            padding: 25px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(255,255,255,0.1) 0%,
                rgba(255,255,255,0) 50%,
                rgba(255,255,255,0.1) 100%);
            z-index: 1;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
        }
        
        .content {
            padding: 25px;
        }
        
        .user-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .user-info p {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            text-align: center;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px 10px;
            width: 45%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .stat-card h3 {
            font-size: 14px;
            margin-bottom: 5px;
            color: #aaa;
        }
        
        .stat-card .value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary); 
        }
        
        .progress-container {
            margin: 25px 0;
            text-align: center;
        }
        
        .progress-label {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }
        
        .progress-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
            background: linear-gradient(90deg, var(--primary), var(--secondary)); 
            border-radius: 10px;
            width: 30%;
            transition: width 0.5s ease;
        }
        
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ø²Ø± Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ - Ù…Ø¹Ø¯Ù„Ø© Ù„Ù„Ø£Ø®Ø¶Ø± */
        .btn-3d {
            position: relative;
            padding: 16px 20px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            color: white;
            text-align: center;
            transition: all 0.2s ease;
            transform-style: preserve-3d;
            perspective: 500px;
            /* Ø¸Ù„ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙŠØ³ØªØ®Ø¯Ù… primary-dark Ù„Ù„Ø¹Ù…Ù‚ */
            box-shadow: 
                0 8px 0 var(--primary-dark), 
                0 15px 20px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-3d::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Ø®Ù„ÙÙŠØ© Ù…ØªØ¯Ø±Ø¬Ø© Ù„Ø³Ø·Ø­ Ø§Ù„Ø²Ø± */
            background: linear-gradient(45deg, var(--primary), var(--secondary)); 
            z-index: -1;
            transition: all 0.3s ease;
        }
        
        .btn-3d::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            /* ØªØ£Ø«ÙŠØ± Ù„Ø§Ù…Ø¹ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: all 0.5s ease;
            z-index: -1;
        }
        
        .btn-3d:hover {
            transform: translateY(4px);
            /* Ø¶Ø¨Ø· Ø§Ù„Ø¸Ù„ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            box-shadow: 
                0 4px 0 var(--primary-dark),
                0 8px 10px rgba(0, 0, 0, 0.3);
        }
        
        .btn-3d:hover::after {
            left: 100%;
        }
        
        .btn-3d:active {
            transform: translateY(8px);
            /* ØªØ³Ø·ÙŠØ­ Ø§Ù„Ø¸Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± */
            box-shadow: 
                0 0 0 var(--primary-dark),
                0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .btn-secondary {
            /* ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ø²Ø± Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ secondary-dark Ù„Ù„Ø¸Ù„ */
            box-shadow: 
                0 8px 0 var(--secondary-dark), 
                0 15px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-secondary::before {
            /* ØªØ¯Ø±Ø¬ Ø®Ù„ÙÙŠØ© Ø§Ù„Ø²Ø± Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ */
            background: linear-gradient(45deg, var(--secondary), var(--primary-dark)); 
        }
        
        .btn-blue { /* Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ù Ø§Ù„Ø¢Ù† Ù‡Ùˆ ÙÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ Ù†ÙØ³ btn-3d Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©/Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© */
            box-shadow: 
                0 8px 0 var(--primary-dark), 
                0 15px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-blue::before {
            background: linear-gradient(45deg, var(--primary), var(--secondary)); 
        }
        
        .website-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .website-section h3 {
            color: var(--secondary); 
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .footer {
            text-align: center;
            padding: 15px;
            color: #777;
            font-size: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .firebase-logo {
            display: inline-block;
            margin-top: 10px;
            font-size: 10px;
            background: rgba(255, 152, 0, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
            color: #ffa726;
        }
        
        .ad-container {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .ad-label {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 10px;
        }
        
        /* Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        .ad-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            z-index: 1000;
            display: none;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 480px) {
            .container {
                border-radius: 15px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .content {
                padding: 20px;
            }
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù„ØºØ© - Ø²Ø± Ù†Ø´Ø· Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
        .language-selector {
            position: absolute;
            top: 15px; 
            right: 15px; 
            display: flex;
            gap: 5px;
            z-index: 999; 
            background-color: rgba(0, 0, 0, 0.3); 
            border-radius: 10px; 
            padding: 5px; 
            backdrop-filter: blur(5px); 
        }
        .language-selector button {
            width: auto;
            padding: 5px 10px;
            font-size: 13px;
            background-color: rgba(255, 255, 255, 0.1); 
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px; 
            cursor: pointer;
            min-width: 30px;
            transition: all 0.2s ease; 
        }
        .language-selector button.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary)); 
            border-color: var(--primary); 
        }
        .language-selector button:hover:not(.active) {
            background-color: rgba(255, 255, 255, 0.2); 
        }

        /* Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ø³Ø­Ø¨ - ØªØ¯Ø±Ø¬ Ø²Ø± Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
        .withdraw-section {
            margin-top: 20px;
            display: none;
            padding: 25px; 
            background-color: rgba(255, 255, 255, 0.05); 
            border-radius: 15px; 
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .withdraw-section h3 {
            color: var(--secondary); 
            margin-bottom: 5px; 
            font-size: 20px;
            font-weight: 600;
        }
        .withdraw-section .warning-message { 
            font-size: 13px;
            color: #FFC107; 
            margin-bottom: 15px;
            line-height: 1.4;
            white-space: pre-wrap; 
        }
        .withdraw-section input, 
        .withdraw-section select { 
            width: 100%;
            padding: 12px;
            margin: 10px 0; 
            border-radius: 10px; 
            /* Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø¯Ù„Ø© Ù„Ù„Ø£Ø®Ø¶Ø± */
            border: 1px solid var(--primary); 
            background-color: var(--dark); 
            color: var(--light);
            font-size: 14px;
        }
        .withdraw-section input::placeholder {
            color: #aaa;
        }
        .withdraw-section input:focus, 
        .withdraw-section select:focus {
            border-color: var(--gold); 
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2);
        }
        .withdraw-section button {
            /* ØªØ¯Ø±Ø¬ Ø²Ø± Ø§Ù„Ø³Ø­Ø¨ Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
            background: linear-gradient(90deg, var(--primary), var(--secondary)); 
            width: 100%;
            padding: 14px; 
            font-size: 16px;
            font-weight: 600;
            margin-top: 20px; 
            border-radius: 15px; 
            cursor: pointer;
            color: white; 
            border: none; 
            box-shadow: 0 8px 0 var(--primary-dark), 0 15px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }
        .withdraw-section button:hover {
            transform: translateY(4px);
            box-shadow: 0 4px 0 var(--primary-dark), 0 8px 10px rgba(0, 0, 0, 0.3);
            /* ØªØ¯Ø±Ø¬ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù…Ø¹Ø¯Ù„ Ù„Ù„Ø£Ø®Ø¶Ø± */
            background: linear-gradient(90deg, var(--secondary), var(--primary)); 
        }
        .withdraw-section button:active {
            transform: translateY(8px);
            box-shadow: 0 0 0 var(--primary-dark), 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© */
        .referral-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        .referral-section h3 {
            color: var(--secondary);
            margin-bottom: 15px;
            font-size: 18px;
        }
        .referral-link-container {
            background-color: var(--dark);
            border: 1px solid var(--primary);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        .referral-link-container input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: var(--light);
            font-size: 14px;
            padding: 0;
            cursor: text;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .referral-link-container button {
            padding: 8px 12px;
            font-size: 14px;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            border: none;
            background: linear-gradient(45deg, var(--secondary), var(--primary));
            transition: all 0.2s ease;
            box-shadow: 0 4px 0 var(--secondary-dark);
        }
        .referral-link-container button:hover {
            transform: translateY(2px);
            box-shadow: 0 2px 0 var(--secondary-dark);
        }
        .referral-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        .referral-stat-item {
            text-align: center;
        }
        .referral-stat-item .value {
            font-size: 22px;
            font-weight: 700;
            color: var(--gold);
        }
        .referral-stat-item .label {
            font-size: 12px;
            color: #aaa;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø±Ø¤ÙŠØ© LLM */
        .llm-insight-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        .llm-insight-section h3 {
            color: var(--secondary);
            margin-bottom: 15px;
            font-size: 18px;
        }
        .llm-insight-text {
            background-color: var(--darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            min-height: 80px; /* Ø¶Ù…Ø§Ù† Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ù†Øµ */
            text-align: left;
            font-size: 14px;
            line-height: 1.5;
            color: #ccc;
            overflow-y: auto; /* Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø·ÙˆÙŠÙ„Ù‹Ø§ */
            max-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .llm-insight-text.loading::after {
            content: '...';
            animation: dot-pulse 1s infinite steps(1, start);
        }
        @keyframes dot-pulse {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
            100% { content: '.'; }
        }
    </style>
</head>
<body>
    <div class="ad-notification" id="ad-notification"></div>
    
    <div class="container">
        <!-- Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù„ØºØ© -->
        <div class="language-selector">
            <button data-lang="ar" onclick="setLanguage('ar')">AR</button>
            <button data-lang="en" onclick="setLanguage('en')">EN</button>
            <button data-lang="ru" onclick="setLanguage('ru')">RU</button>
        </div>

        <div class="header">
            <h1 data-key="app_title">â›ï¸Ø´ØºÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‡ ÙˆØ§Ø¯Ù‡Ø¨ Ù„ÙŠ Ø§Ù„Ù†ÙˆÙ… ğŸ˜´ÙˆØ§Ø³ØªÙ…ØªØ¹ Ø¨ÙŠ Ø§Ù„Ø§Ø±Ø¨Ø§Ø­ğŸ¤«ğŸ’µ</h1>
        </div>
        
        <div class="content">
            <div class="user-info">
                <p data-key="earn_per_click_message">Ø§Ø±Ø¨Ø­ 5 Ø¹Ù…Ù„Ø§Øª pepe Ù„ÙƒÙ„ Ù†Ù‚Ø±Ø©ğŸ”¥</p>
                <p data-key="min_withdrawal_message_static_general">Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ FaucetPay Ù…Ù† 10 Ø¹Ù…Ù„Ø§Øª ÙÙ‚Ø· âœ…<br>Ø§Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰ Ù…Ù† 100 Ø¹Ù…Ù„Ø© ÙÙ‚Ø· âœ…</p>
                <p id="user-id-display"></p> <!-- Ø¹Ø±Ø¶ Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… -->
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <h3 data-key="watched_ads_label">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</h3>
                    <div class="value" id="watched-ads">0</div>
                </div>
                <div class="stat-card">
                    <h3 data-key="earned_points_label">Ø¹Ù…Ù„Ø§Øª Pepe Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©</h3>
                    <div class="value" id="earned-points">0.00</div>
                </div>
            </div>
            
            <div class="stats"> 
                <div class="stat-card">
                    <h3 data-key="daily_limit_label">Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
                    <div class="value" id="daily-watched-ads">0 / 100</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-label">
                    <span data-key="progress_to_bonus">Ø§Ù„ØªÙ‚Ø¯Ù… Ù„Ù„Ù…ÙƒØ§ÙØ£Ø©</span>
                    <span id="ads-progress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            
            <div class="ad-container">
                <div class="ad-label" data-key="ad_type_label">Ø¥Ø¹Ù„Ø§Ù† Adsgram Ø¨ÙŠÙ†ÙŠ</div>
                <div class="buttons">
                    <button class="btn-3d" id="watch-ad-btn" onclick="watchAd()" data-key="watch_ad_btn_with_points">Ø´Ø§Ù‡Ø¯ Ø¥Ø¹Ù„Ø§Ù† (+10.00 Ø¹Ù…Ù„Ø© pepe)</button>
                    <button class="btn-3d btn-secondary" id="auto-ad-btn" onclick="startAutoAds()" data-key="auto_show_ads_btn">Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</button>
                    <button class="btn-3d" id="stop-auto-btn" onclick="stopAutoAds()" data-key="stop_auto_ads_btn">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
                    <button class="btn-3d btn-blue" id="show-withdraw-btn" onclick="showWithdrawForm()" data-key="withdraw_points_btn">Ø³Ø­Ø¨ Ø¹Ù…Ù„Ø§Øª Pepe</button>
                    <!-- Ø²Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ LLM -->
                    <button class="btn-3d btn-blue" id="get-insight-btn" onclick="getAdInsight()" data-key="get_ad_insight_btn">âœ¨ Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª âœ¨</button>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ LLM -->
            <div class="llm-insight-section">
                <h3 data-key="llm_insight_title">Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
                <div class="llm-insight-text" id="dogs-insight-text" data-key="llm_insight_placeholder">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¤ÙŠØ© Ø­ÙˆÙ„ Ø£Ø¯Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†Ø§ØªÙƒ.</div>
            </div>

            <!-- Ù‚Ø³Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© -->
            <div class="referral-section">
                <h3 data-key="referral_title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h3>
                <p data-key="referral_desc">Ø§Ø¯Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙˆØ§ÙƒØ³Ø¨ Ù…ÙƒØ§ÙØ¢Øª!</p>
                <div class="referral-link-container">
                    <input type="text" id="referral-link" readonly value="Loading referral link...">
                    <button onclick="copyReferralLink()" data-key="copy_link_btn">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                </div>
                <div class="referral-stats">
                    <div class="referral-stat-item">
                        <div class="value" id="referred-users-count">0</div>
                        <div class="label" data-key="referred_users_label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø¯Ø¹ÙˆÙˆÙ†</div>
                    </div>
                    <div class="referral-stat-item">
                        <div class="value" id="referral-bonus-earned">0.00</div>
                        <div class="label" data-key="referral_bonus_earned_label">Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</div>
                    </div>
                </div>
            </div>
            
            <div class="website-section">
                <h3 data-key="visit_channel_title">Ù‚Ù… Ø¨Ø²ÙŠØ§Ø±Ø© Ù‚Ù†Ø§ØªÙ†Ø§ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</h3>
                <button class="btn-3d btn-blue" onclick="window.open('https://t.me/dogsarn', '_blank')" data-key="visit_channel_button">Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ù†Ø§Ø©</button>
            </div>
        </div>
        
        <div class="footer">
            <p data-key="footer_text">Ù…Ø¤Ù…Ù† Ø¨ÙˆØ§Ø³Ø·Ø© Firebase â€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø­Ù…ÙŠØ©</p>
            <div class="firebase-logo">Firebase</div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø³Ø­Ø¨ - ØªÙ… Ù†Ù‚Ù„Ù‡ Ù‡Ù†Ø§ Ù„ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¤Ù‡/Ø¥Ø¸Ù‡Ø§Ø±Ù‡ -->
        <div class="withdraw-section" id="withdraw-section">
            <h3 data-key="withdrawal_request_title">Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨</h3>
            <p class="warning-message" data-key="withdrawal_warning">ØªÙ†Ø¨ÙŠÙ‡ ğŸ™‹ğŸ»â€â™‚ï¸
Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ FaucetPay Ù‡Ùˆ 10 Ø¹Ù…Ù„Ø§Øª pepe.
Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰ Ù‡Ùˆ 100 Ø¹Ù…Ù„Ø© pepe.
ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ù…Ø­ÙØ¸Ø© ØµØ­ÙŠØ­ Ù„ØªÙ„Ù‚ÙŠ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„ (â—â€¢á´—â€¢â—)</p>
            <input type="number" id="withdraw-amount" data-key-placeholder="enter_points_placeholder" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ù„Ø³Ø­Ø¨ Ø¹Ù…Ù„Ø§Øª Pepe" />
            <select id="payment-method"> 
                <option value="faucetpay" data-key="faucetpay_option">FaucetPay</option>
                <option value="other_wallet" data-key="other_wallet_option">Ø§Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰</option>
            </select>
            <input type="text" id="wallet-address" data-key-placeholder="wallet_address_placeholder" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©" /> 
            <button onclick="withdrawPoints()" data-key="withdraw_button">Ø³Ø­Ø¨</button>
            <p id="withdraw-status"></p>
        </div>
    </div>

    <!-- Adsgram SDK -->
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>

    <!-- Ø³ÙƒØ±Ø¨Øª Firebase Ø§Ù„Ù…ÙˆØ­Ø¯ ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <script type="module">
        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ­Ø¯Ø§Øª Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, query, where, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Ø§Ù„Ø«ÙˆØ§Ø¨Øª
        const POINTS_PER_AD = 10.00; // Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù„ÙƒÙ„ Ø¥Ø¹Ù„Ø§Ù† Ù‡ÙŠ Ø§Ù„Ø¢Ù† 10.00 Ø¹Ù…Ù„Ø© Pepe
        const ADS_FOR_BONUS = 10; 
        const MIN_WITHDRAW_POINTS = 100; // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù„Ù„Ù…Ø­Ø§ÙØ¸ Ø§Ù„Ø£Ø®Ø±Ù‰
        const MIN_WITHDRAW_POINTS_FAUCETPAY = 10; // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù„Ù€ FaucetPay
        const DAILY_AD_LIMIT = 100; // Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ù‡Ùˆ Ø§Ù„Ø¢Ù† 100
        const REFERRAL_BONUS_ADS_COUNT = 5; // Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ´Ø§Ù‡Ø¯Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø­ÙŠÙ„
        const REFERRAL_BONUS_AMOUNT = 50.00; // Ù…Ø¨Ù„Øº Ø¹Ù…Ù„Ø§Øª Pepe Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø­ÙŠÙ„
        const ADMIN_USER_ID = "-1002705355317"; // Ù…Ø¹Ø±Ù Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø³Ø¤ÙˆÙ„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        const BOT_TOKEN = "7509054222:AAFhFhVXFCOs4kXtHQBigGU2QeNamHX42LQ"; // ØªÙˆÙƒÙ† Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        const BOT_USERNAME = "ididkd46_bot"; // Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (ØªÙ… ØªØ±ÙƒÙŠØ¨Ù‡ Ù‡Ù†Ø§)

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© (Ø§Ù„Ø¢Ù† Ù…ØªØ²Ø§Ù…Ù†Ø© Ø¨Ø´ÙƒÙ„ Ø£Ø³Ø§Ø³ÙŠ Ù…Ø¹ Firestore)
        let currentUserData = { // Ù‡ÙŠÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            telegramUserId: null,
            telegramUsername: 'AnonymousUser', // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ±
            earnedPoints: 0.00,
            watchedAdsCount: 0,
            dailyWatchedAdsCount: 0,
            lastWatchDate: '',
            referrerId: null, // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ø­Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            referredUsersCount: 0, // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ø£Ø­Ø§Ù„Ù‡Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            referralBonusEarned: 0.00, // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø© Ù…Ù† Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª
            isNewUser: true, // Ø¹Ù„Ø§Ù…Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠ
            referredAdsWatched: 0, // Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø´Ø§Ù‡Ø¯Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„ (ÙŠØªÙ… ØªØªØ¨Ø¹Ù‡Ø§ Ù„Ù„Ù…ÙƒØ§ÙØ£Ø©)
            hasReceivedReferralBonusForThisUser: false // Ø¹Ù„Ø§Ù…Ø© Ù„Ø¶Ù…Ø§Ù† Ø­ØµÙˆÙ„ Ø§Ù„Ù…Ø­ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø§Ù„
        };
        let autoAdInterval;
        
        // Ù…Ø«ÙŠÙ„Ø§Øª Firebase
        let firebaseApp;
        let firebaseDb;
        let firebaseAuth;
        let firebaseCurrentUserId = null; // Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… Firebase Auth
        let isFirebaseInitialized = false;

        // Ù…ØªØºÙŠØ±Ø§Øª Firebase - Ù„Ø§ ØªØ¹Ø¯Ù„. ÙŠØªÙ… ØªÙˆÙÙŠØ±Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¨ÙŠØ¦Ø© Canvas.
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Ø¹Ù†Ø§ØµØ± DOM
        const watchedAdsEl = document.getElementById('watched-ads');
        const earnedPointsEl = document.getElementById('earned-points');
        const dailyWatchedAdsEl = document.getElementById('daily-watched-ads'); 
        const adsProgressEl = document.getElementById('ads-progress');
        const progressFillEl = document.getElementById('progress-fill');
        const adNotificationEl = document.getElementById('ad-notification');
        const withdrawSectionEl = document.getElementById('withdraw-section');
        const withdrawStatusEl = document.getElementById('withdraw-status');
        const watchAdBtn = document.getElementById('watch-ad-btn');
        const autoAdBtn = document.getElementById('auto-ad-btn');
        const stopAutoBtn = document.getElementById('stop-auto-btn');
        const userIdDisplayEl = document.getElementById('user-id-display'); // Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        // Ø¹Ù†Ø§ØµØ± DOM Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
        const referralLinkInput = document.getElementById('referral-link');
        const referredUsersCountEl = document.getElementById('referred-users-count');
        const referralBonusEarnedEl = document.getElementById('referral-bonus-earned');
        // Ø¹Ù†Ø§ØµØ± DOM Ù„Ø±Ø¤ÙŠØ© LLM
        const getInsightBtn = document.getElementById('get-insight-btn');
        const dogsInsightTextEl = document.getElementById('dogs-insight-text');

        // --- Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø© ---
        const translations = {
            ar: {
                app_title: "â›ï¸Ø´ØºÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‡ ÙˆØ§Ø¯Ù‡Ø¨ Ù„ÙŠ Ø§Ù„Ù†ÙˆÙ… ğŸ˜´ÙˆØ§Ø³ØªÙ…ØªØ¹ Ø¨ÙŠ Ø§Ù„Ø§Ø±Ø¨Ø§Ø­ğŸ¤«ğŸ’µ",
                earn_per_click_message: "Ø§Ø±Ø¨Ø­ 5 Ø¹Ù…Ù„Ø§Øª pepe Ù„ÙƒÙ„ Ù†Ù‚Ø±Ø©ğŸ”¥", 
                min_withdrawal_message_static_general: `Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ FaucetPay Ù…Ù† ${MIN_WITHDRAW_POINTS_FAUCETPAY} Ø¹Ù…Ù„Ø§Øª ÙÙ‚Ø· âœ…\nØ§Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰ Ù…Ù† ${MIN_WITHDRAW_POINTS} Ø¹Ù…Ù„Ø© ÙÙ‚Ø· âœ…`, 
                watched_ads_label: "Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©",
                earned_points_label: "Ø¹Ù…Ù„Ø§Øª Pepe Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©", 
                daily_limit_label: "Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©", 
                progress_to_bonus: "Ø§Ù„ØªÙ‚Ø¯Ù… Ù„Ù„Ù…ÙƒØ§ÙØ£Ø©",
                ad_type_label: "Ø¥Ø¹Ù„Ø§Ù† Adsgram Ø¨ÙŠÙ†ÙŠ",
                watch_ad_btn_with_points: `Ø´Ø§Ù‡Ø¯ Ø¥Ø¹Ù„Ø§Ù† (+${POINTS_PER_AD.toFixed(2)} Ø¹Ù…Ù„Ø© pepe)`, 
                auto_show_ads_btn: "Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹",
                stop_auto_ads_btn: "Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ",
                withdraw_points_btn: "Ø³Ø­Ø¨ Ø¹Ù…Ù„Ø§Øª Pepe", 
                visit_channel_title: "Ù‚Ù… Ø¨Ø²ÙŠØ§Ø±Ø© Ù‚Ù†Ø§ØªÙ†Ø§ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…", 
                visit_channel_button: "Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù‚Ù†Ø§Ø©", 
                footer_text: "Ù…Ø¤Ù…Ù† Ø¨ÙˆØ§Ø³Ø·Ø© Firebase â€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø­Ù…ÙŠØ©",
                withdrawal_request_title: "Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨",
                withdrawal_warning: `ØªÙ†Ø¨ÙŠÙ‡ ğŸ™‹ğŸ»â€â™‚ï¸\nØ§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ FaucetPay Ù‡Ùˆ ${MIN_WITHDRAW_POINTS_FAUCETPAY} Ø¹Ù…Ù„Ø§Øª pepe.\nØ§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰ Ù‡Ùˆ ${MIN_WITHDRAW_POINTS} Ø¹Ù…Ù„Ø© pepe.\nÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ù…Ø­ÙØ¸Ø© ØµØ­ÙŠØ­ Ù„ØªÙ„Ù‚ÙŠ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„ (â—â€¢á´—â€¢â—)`, 
                enter_points_placeholder: "Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ù„Ø³Ø­Ø¨ Ø¹Ù…Ù„Ø§Øª Pepe", 
                faucetpay_option: "FaucetPay",
                other_wallet_option: "Ø§Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰",
                wallet_address_placeholder: "Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©",
                withdraw_button: "Ø³Ø­Ø¨",
                ad_loading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
                ad_completed_success: `Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†! ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${POINTS_PER_AD.toFixed(2)} Ø¹Ù…Ù„Ø© pepe Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ`, 
                ad_failed: "ÙØ´Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
                auto_ads_started_notification: "Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. Ø³ØªØ¹Ù…Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©.",
                auto_ads_stopped_notification: "ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª.",
                daily_limit_reached: `Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (${DAILY_AD_LIMIT}). ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ØºØ¯Ù‹Ø§.`, 
                min_withdraw_message: `Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ø¹Ù† Ø·Ø±ÙŠÙ‚ {methodName} Ù‡Ùˆ {minAmount} Ø¹Ù…Ù„Ø© pepe.`, 
                insufficient_balance: `Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ. Ù„Ø¯ÙŠÙƒ {earnedPoints} Ø¹Ù…Ù„Ø© pepe.`, 
                enter_wallet_address: "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©.",
                withdrawal_success_message: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­!',
                telegram_send_fail: `ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨: {error}`,
                telegram_connect_error: `Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…: {error}`,
                unknown_method: "Ø·Ø±ÙŠÙ‚Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©:",
                // ØªØ±Ø¬Ù…Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                referral_title: "Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©",
                referral_desc: `Ø§Ø¯Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙˆØ§ÙƒØ³Ø¨ ${REFERRAL_BONUS_AMOUNT.toFixed(2)} Ø¹Ù…Ù„Ø© pepe Ø¹Ù†Ø¯ Ù…Ø´Ø§Ù‡Ø¯ØªÙ‡Ù… Ø£ÙˆÙ„ ${REFERRAL_BONUS_ADS_COUNT} Ø¥Ø¹Ù„Ø§Ù†!`,
                copy_link_btn: "Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·",
                copy_link_success: "ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©!",
                referred_users_label: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø¯Ø¹ÙˆÙˆÙ†",
                referral_bonus_earned_label: "Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø©",
                user_id_display: "Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: {userId}",
                referral_link_loading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©...",
                // ØªØ±Ø¬Ù…Ø§Øª Ø±Ø¤ÙŠØ© LLM
                get_ad_insight_btn: "âœ¨ Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª âœ¨",
                llm_insight_title: "Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª",
                llm_insight_placeholder: "Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¤ÙŠØ© Ø­ÙˆÙ„ Ø£Ø¯Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù†Ø§ØªÙƒ.",
                llm_insight_loading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¦Ùƒ... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
                llm_insight_error: "Ø¹Ø°Ø±Ù‹Ø§ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø¤ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
                llm_insight_no_id: "ØºÙŠØ± Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… ØºÙŠØ± Ù…ØªØ§Ø­. ÙŠØ±Ø¬Ù‰ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ø¨Ø± Ø²Ø± Ø§Ù„Ø¨ÙˆØª ÙÙŠ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….",
            },
            en: {
                app_title: "â›ï¸Enable Auto Watch, Go to Sleep ğŸ˜´, and Enjoy the ProfitsğŸ¤«ğŸ’µ", 
                earn_per_click_message: "Earn 5 Pepe coins per clickğŸ”¥", 
                min_withdrawal_message_static_general: `Withdrawal via FaucetPay from ${MIN_WITHDRAW_POINTS_FAUCETPAY} pepe coins only âœ…\nWithdrawal to Any Other Wallet from ${MIN_WITHDRAW_POINTS} pepe coins only âœ…`, 
                watched_ads_label: "Watched Ads",
                earned_points_label: "Earned Pepe Coins", 
                daily_limit_label: "Daily Views", 
                progress_to_bonus: "Progress to Bonus",
                ad_type_label: "Adsgram Interstitial Ad",
                watch_ad_btn_with_points: `Watch Ad (+${POINTS_PER_AD.toFixed(2)} Pepe Coins)`, 
                auto_show_ads_btn: "Auto Show Ads",
                stop_auto_ads_btn: "Stop Auto Ads",
                withdraw_points_btn: "Withdraw Pepe Coins", 
                visit_channel_title: "Visit Our Telegram Channel", 
                visit_channel_button: "Visit Channel", 
                footer_text: "Secured by Firebase â€¢ All transactions are protected",
                withdrawal_request_title: "Withdrawal Request",
                withdrawal_warning: `Warning ğŸ™‹ğŸ»â€â™‚ï¸\nMinimum withdrawal for FaucetPay is ${MIN_WITHDRAW_POINTS_FAUCETPAY} pepe coins.\nMinimum withdrawal for Any Other Wallet is ${MIN_WITHDRAW_POINTS} pepe coins.\nPlease ensure you enter a correct wallet address for smooth withdrawals (â—â€¢á´—â€¢â—)`, 
                enter_points_placeholder: "Enter Amount to Withdraw Pepe Coins", 
                faucetpay_option: "FaucetPay",
                other_wallet_option: "Withdraw to Any Other Wallet",
                wallet_address_placeholder: "Enter Wallet Address",
                withdraw_button: "Withdraw",
                ad_loading: "Loading ad... Please wait",
                ad_completed_success: `Ad completed! +${POINTS_PER_AD.toFixed(2)} Pepe Coins added to your account`, 
                ad_failed: "Failed to show ad. Please try again.",
                auto_ads_started_notification: "Auto ads started. Ads will play every 30 seconds.",
                auto_ads_stopped_notification: "Auto ads stopped.",
                daily_limit_reached: `You have reached the daily ad limit (${DAILY_AD_LIMIT}). Please try again tomorrow.`, 
                min_withdraw_message: `Minimum withdrawal for {methodName} is {minAmount} pepe coins.`, 
                insufficient_balance: `Insufficient balance. You have {earnedPoints} Pepe Coins.`, 
                enter_wallet_address: "Please enter the wallet address.",
                withdrawal_success_message: 'Withdrawal request sent successfully!',
                telegram_send_fail: `Failed to send request: {error}`,
                telegram_connect_error: `Error connecting to Telegram service: {error}`,
                unknown_method: "Unknown method:",
                // Referral system translations
                referral_title: "Referral System",
                referral_desc: `Invite your friends and earn ${REFERRAL_BONUS_AMOUNT.toFixed(2)} pepe coins when they watch their first ${REFERRAL_BONUS_ADS_COUNT} ads!`,
                copy_link_btn: "Copy Link",
                copy_link_success: "Referral link copied!",
                referred_users_label: "Referred Users",
                referral_bonus_earned_label: "Referral Bonus Earned",
                user_id_display: "User ID: {userId}",
                referral_link_loading: "Loading referral link...",
                // LLM Insight translations
                get_ad_insight_btn: "âœ¨ Get Ad Performance Insight âœ¨",
                llm_insight_title: "Ad Performance Insight",
                llm_insight_placeholder: "Click the button above to get insight into your ad performance.",
                llm_insight_loading: "Analyzing your performance... Please wait",
                llm_insight_error: "Sorry, an error occurred while fetching insight. Please try again.",
                llm_insight_no_id: "Cannot generate referral link: Telegram user ID not available. Please open the app via the bot button in Telegram.",
            },
            ru: {
                app_title: "â›ï¸Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸ Ğ¸Ğ´Ğ¸ ÑĞ¿Ğ°Ñ‚ÑŒ ğŸ˜´, Ğ½Ğ°ÑĞ»Ğ°Ğ¶Ğ´Ğ°Ğ¹ÑÑ Ğ¿Ñ€Ğ¸Ğ±Ñ‹Ğ»ÑŒÑğŸ¤«ğŸ’µ", 
                earn_per_click_message: "Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ¹Ñ‚Ğµ 5 Ğ¼Ğ¾Ğ½ĞµÑ‚ Pepe Ğ·Ğ° ĞºĞ»Ğ¸ĞºğŸ”¥", 
                min_withdrawal_message_static_general: `Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ñ‡ĞµÑ€ĞµĞ· FaucetPay Ğ¾Ñ‚ ${MIN_WITHDRAW_POINTS_FAUCETPAY} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ âœ…\nĞ’Ñ‹Ğ²Ğ¾Ğ´ Ğ½Ğ° Ğ»ÑĞ±Ğ¾Ğ¹ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ ĞºĞ¾ÑˆĞµĞ»ĞµĞº Ğ¾Ñ‚ ${MIN_WITHDRAW_POINTS} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ âœ…`, 
                watched_ads_label: "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ½Ğ¾ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹",
                earned_points_label: "Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹ Pepe", 
                daily_limit_label: "Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ñ‹", 
                progress_to_bonus: "ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğº Ğ±Ğ¾Ğ½ÑƒÑÑƒ",
                ad_type_label: "ĞœĞµĞ¶ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ½Ğ°Ñ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ° Adsgram",
                watch_ad_btn_with_points: `Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñƒ (+${POINTS_PER_AD.toFixed(2)} Ğ¼Ğ¾Ğ½ĞµÑ‚ Pepe)`, 
                auto_show_ads_btn: "ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ğ¾ĞºĞ°Ğ· Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñ‹",
                stop_auto_ads_btn: "ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ°Ğ²Ñ‚Ğ¾Ğ¿Ğ¾ĞºĞ°Ğ·",
                withdraw_points_btn: "Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹ Pepe", 
                visit_channel_title: "ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚Ğµ Ğ½Ğ°Ñˆ Telegram-ĞºĞ°Ğ½Ğ°Ğ»", 
                visit_channel_button: "ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ½Ğ°Ğ»", 
                footer_text: "Ğ—Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ¾ Firebase â€¢ Ğ’ÑĞµ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ñ‹",
                withdrawal_request_title: "Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´",
                withdrawal_warning: `Ğ’Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ ğŸ™‹ğŸ»â€â™‚ï¸\nĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ´Ğ»Ñ FaucetPay ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ ${MIN_WITHDRAW_POINTS_FAUCETPAY} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe.\nĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ´Ğ»Ñ Ğ»ÑĞ±Ğ¾Ğ³Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ° ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ ${MIN_WITHDRAW_POINTS} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe.\nĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, ÑƒĞ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ²Ğ²ĞµĞ»Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ´Ñ€ĞµÑ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ° Ğ´Ğ»Ñ Ğ±ĞµÑĞ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° ÑÑ€ĞµĞ´ÑÑ‚Ğ² (â—â€¢á´—â€¢â—)`, 
                enter_points_placeholder: "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑƒĞ¼Ğ¼Ñƒ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ¼Ğ¾Ğ½ĞµÑ‚ Pepe", 
                faucetpay_option: "FaucetPay",
                other_wallet_option: "Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ğ½Ğ° Ğ»ÑĞ±Ğ¾Ğ¹ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ ĞºĞ¾ÑˆĞµĞ»ĞµĞº",
                wallet_address_placeholder: "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ°Ğ´Ñ€ĞµÑ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°",
                withdraw_button: "Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸",
                ad_loading: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñ‹... ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ",
                ad_completed_success: `Ğ ĞµĞºĞ»Ğ°Ğ¼Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°! +${POINTS_PER_AD.toFixed(2)} Ğ¼Ğ¾Ğ½ĞµÑ‚ Pepe Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ½Ğ° Ğ²Ğ°Ñˆ ÑÑ‡ĞµÑ‚`, 
                ad_failed: "ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñƒ. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.",
                auto_ads_started_notification: "ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ğ¾ĞºĞ°Ğ· Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½. Ğ ĞµĞºĞ»Ğ°Ğ¼Ğ° Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞºÑƒĞ½Ğ´.",
                auto_ads_stopped_notification: "ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ°Ğ²Ñ‚Ğ¾Ğ¿Ğ¾ĞºĞ°Ğ·.",
                daily_limit_reached: `Ğ’Ñ‹ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ»Ğ¸ Ğ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ³Ğ¾ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ° Ğ¿Ğ¾ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğµ (${DAILY_AD_LIMIT}). ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ·Ğ°Ğ²Ñ‚Ñ€Ğ°.`, 
                min_withdraw_message: `ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ´Ğ»Ñ {methodName} ÑĞ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ {minAmount} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe.`, 
                insufficient_balance: `ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ. Ğ£ Ğ²Ğ°Ñ {earnedPoints} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe.`, 
                enter_wallet_address: "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ°Ğ´Ñ€ĞµÑ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°.",
                withdrawal_success_message: 'Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½!',
                telegram_send_fail: `ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ: {error}`,
                telegram_connect_error: `ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº ÑĞ»ÑƒĞ¶DĞ±Ğµ Telegram: {error}`,
                unknown_method: "ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´:",
                // Referral system translations
                referral_title: "Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°",
                referral_desc: `ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ğ¹Ñ‚Ğµ Ğ´Ñ€ÑƒĞ·ĞµĞ¹ Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ ${REFERRAL_BONUS_AMOUNT.toFixed(2)} Ğ¼Ğ¾Ğ½ĞµÑ‚ pepe, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¾Ğ½Ğ¸ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ÑÑ‚ ÑĞ²Ğ¾Ğ¸ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ ${REFERRAL_BONUS_ADS_COUNT} Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹!`,
                copy_link_btn: "Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ",
                copy_link_success: "Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ° ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!",
                referred_users_label: "ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸",
                referral_bonus_earned_label: "Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾ Ğ¿Ğ¾ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ",
                user_id_display: "Ğ˜Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ: {userId}",
                referral_link_loading: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑÑÑ‹Ğ»ĞºĞ¸...",
                // LLM Insight translations
                get_ad_insight_btn: "âœ¨ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñ‹ âœ¨",
                llm_insight_title: "ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñ‹",
                llm_insight_placeholder: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ²Ñ‹ÑˆĞµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ²Ğ°ÑˆĞµĞ¹ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ½Ğ¾Ğ¹ ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸.",
                llm_insight_loading: "ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ²Ğ°ÑˆĞµĞ¹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸... ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ",
                llm_insight_error: "Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.",
                llm_insight_no_id: "ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½ÑƒÑ ÑÑÑ‹Ğ»ĞºÑƒ: Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Telegram Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¾Ñ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ±Ğ¾Ñ‚Ğ° Ğ² Telegram.",
            }
        };

        let currentLanguage = localStorage.getItem('appLanguage') || 'ar'; // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ùˆ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        let appInitialized = false; // Ø¹Ù„Ø§Ù…Ø© Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©

        // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø¨ØªÙ†Ø³ÙŠÙ‚ YYYY-MM-DD
        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0'); // Ø§Ù„Ø£Ø´Ù‡Ø± ØªØ¨Ø¯Ø£ Ù…Ù† 0
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ØºØ©
        window.setLanguage = function(lang) {
            currentLanguage = lang;
            localStorage.setItem('appLanguage', lang);
            document.documentElement.lang = lang; // ØªØ¹ÙŠÙŠÙ† Ø³Ù…Ø© HTML lang

            // ØªØ­Ø¯ÙŠØ« Ù†Ù…Ø· Ø§Ù„Ø²Ø± Ø§Ù„Ù†Ø´Ø·
            document.querySelectorAll('.language-selector button').forEach(button => {
                if (button.dataset.lang === lang) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });

            // ØªØ±Ø¬Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø°Ø§Øª Ø³Ù…Ø© data-key
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.dataset.key;
                if (translations[lang] && translations[lang][key]) {
                    if (element.tagName === 'INPUT' && element.hasAttribute('data-key-placeholder')) {
                        element.placeholder = translations[lang][key];
                    } else if (key === 'watch_ad_btn_with_points' || key === 'ad_completed_success') {
                         element.textContent = translations[lang][key];
                    } else if (key === 'daily_limit_reached') { 
                        element.textContent = translations[lang][key].replace(`(${DAILY_AD_LIMIT})`, `(${DAILY_AD_LIMIT})`); 
                    } else if (key === 'insufficient_balance') {
                        element.textContent = translations[lang][key].replace('{earnedPoints}', currentUserData.earnedPoints.toFixed(2));
                    } else if (key === 'min_withdrawal_message') { // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© min_withdrawal_message
                        // Ù‡Ø°Ù‡ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§ Ø¯Ø§Ø®Ù„ withdrawPoints Ù„ØªÙƒÙˆÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
                        // Ù„Ø°Ø§ Ù„Ø§ Ù†Ù‚Ù… Ø¨ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© Ù‡Ù†Ø§
                    }
                    else {
                        element.textContent = translations[lang][key];
                    }
                }
            });

            // ØªØ±Ø¬Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø°Ø§Øª Ø³Ù…Ø© data-key-placeholder
            document.querySelectorAll('[data-key-placeholder]').forEach(element => {
                const placeholderKey = element.dataset.keyPlaceholder;
                if (translations[lang] && translations[lang][placeholderKey]) {
                    element.placeholder = translations[lang][placeholderKey];
                }
            });

            // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
            document.querySelectorAll('#payment-method option').forEach(option => {
                const key = option.dataset.key;
                if (translations[lang] && translations[lang][key]) {
                    option.textContent = translations[lang][key];
                }
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
            // ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† referral_desc Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
            const referralDescEl = document.querySelector('[data-key="referral_desc"]');
            if (referralDescEl) {
                referralDescEl.textContent = translations[lang].referral_desc;
            }
            // Ø¹Ø±Ø¶ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (currentUserData.telegramUserId) {
                userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', currentUserData.telegramUserId);
            } else if (firebaseCurrentUserId) { // Ø¨Ø¯ÙŠÙ„ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ± (Ù…Ø¹Ø±Ù Firebase Auth)
                 userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', firebaseCurrentUserId);
            } else {
                 userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', "N/A"); // Ø£Ùˆ Ø¥Ø®ÙØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ±
            }


            // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ (Ù…Ø«Ù„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…)
            updateUI();
            showAdNotification(''); 
            withdrawStatusEl.textContent = ''; 
        };

        // Ø¯Ø§Ù„Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        async function initApp() {
            if (appInitialized) return; // Ù…Ù†Ø¹ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©
            appInitialized = true;
            console.log("initApp: Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.");

            // 1. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ± (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‚Ø§Ø¨Ù„Ø§Ù‹ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚)
            if (window.Telegram && window.Telegram.WebApp) {
                const tgInitData = window.Telegram.WebApp.initDataUnsafe;
                console.log("initApp: Telegram WebApp initDataUnsafe:", tgInitData);
                if (tgInitData && tgInitData.user) {
                    currentUserData.telegramUserId = String(tgInitData.user.id);
                    currentUserData.telegramUsername = tgInitData.user.username || tgInitData.user.first_name || 'Anonymous';
                    console.log("initApp: ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† initDataUnsafe:", currentUserData.telegramUserId, currentUserData.telegramUsername);

                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ÙŠÙ„ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ ÙÙŠ start_param
                    if (tgInitData.start_param) {
                        const referrerId = tgInitData.start_param;
                        if (referrerId !== currentUserData.telegramUserId) { // Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ù„Ù„Ù†ÙØ³
                            currentUserData.referrerId = referrerId;
                            console.log("initApp: ØªÙ…Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø¨ÙˆØ§Ø³Ø·Ø©:", referrerId);
                        }
                    }
                } else {
                    console.warn("initApp: Telegram WebApp initDataUnsafe.user ØºÙŠØ± Ù…ØªØ§Ø­. ØªØ£ÙƒØ¯ Ù…Ù† ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ø¨Ø± Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….");
                }
            } else {
                 console.warn("initApp: Ù„Ù… ÙŠØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø­Ø²Ù…Ø© SDK Ù„ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ±. Ù‚Ø¯ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙƒØµÙØ­Ø© ÙˆÙŠØ¨ Ù…Ø³ØªÙ‚Ù„Ø©.");
            }

            // 2. ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ±ÙŠØ¯ Ù„Ù€ Firestore
            // Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹ØŒ ÙˆØ¥Ù„Ø§ ÙÙ…Ø¹Ø±Ù Firebase Auth
            const userIdForFirestore = currentUserData.telegramUserId || firebaseCurrentUserId;
            console.log("initApp: ØªÙ… ØªØ­Ø¯ÙŠØ¯ userIdForFirestore Ù„Ø¹Ù…Ù„ÙŠØ§Øª Firestore:", userIdForFirestore);

            if (!userIdForFirestore) {
                console.error("initApp: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØµØ§Ù„Ø­ Ù„Ù€ Firestore. Ù‚Ø¯ ØªÙØ´Ù„ Ø¹Ù…Ù„ÙŠØ§Øª Firebase. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ø¨Ø³Ø¨Ø¨ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø®Ø§Ø±Ø¬ Ø³ÙŠØ§Ù‚ ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ± Ø£Ùˆ Ù…Ø´ÙƒÙ„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Firebase.");
                showAdNotification(translations[currentLanguage].llm_insight_no_id); // Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø¹Ø±Ù
                // Ù„Ø§ ÙŠØ²Ø§Ù„ Ø¨Ø¥Ù…ÙƒØ§Ù†Ù†Ø§ ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙˆÙ…Ø­Ø§ÙˆÙ„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                updateUI(); 
                generateReferralLink(); // Ø³ÙŠØ¹Ø±Ø¶ Ù‡Ø°Ø§ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·
                return; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ø¹Ù„Ù‰ Firebase
            } 
            
            // 3. ØªØ­Ù…ÙŠÙ„ Ø£Ùˆ ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firestore
            if (isFirebaseInitialized) {
                const userDocRef = doc(firebaseDb, `artifacts/${appId}/users/${userIdForFirestore}/appData/userData`);
                console.log("initApp: Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firestore Ù„Ù„Ù…Ø³ØªÙ†Ø¯:", userDocRef.path);

                try {
                    const userDocSnap = await getDoc(userDocRef);

                    if (userDocSnap.exists()) {
                        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ù† Firestore
                        const data = userDocSnap.data();
                        currentUserData = { 
                            ...currentUserData, // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ…Ø¯Ø© Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
                            ...data, // Ø§Ù„ØªØ±Ø§ÙƒØ¨ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Firestore (Ù…Ø«Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·ØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©ØŒ Ø¥Ù„Ø®)
                            isNewUser: false // Ù„ÙŠØ³ Ù…Ø³ØªØ®Ø¯Ù…Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                        };
                        console.log("initApp: ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ù† Firestore:", currentUserData);

                        // Ù…Ù†Ø·Ù‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠÙˆÙ…Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©)
                        const todayDate = getTodayDate();
                        if (currentUserData.lastWatchDate !== todayDate) {
                            console.log("initApp: ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯. Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.");
                            currentUserData.dailyWatchedAdsCount = 0;
                            currentUserData.lastWatchDate = todayDate;
                            await setDoc(userDocRef, { dailyWatchedAdsCount: 0, lastWatchDate: todayDate }, { merge: true });
                        }

                    } else {
                        // Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯: Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙŠ Firestore
                        console.log("initApp: ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯. Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙŠ Firestore.");
                        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ‡ÙŠØ¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù†Øª Ø¨ÙŠØ§Ù†Ø§Øª initData Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¬Ø²Ø¦ÙŠØ©
                        currentUserData.watchedAdsCount = currentUserData.watchedAdsCount || 0;
                        currentUserData.earnedPoints = currentUserData.earnedPoints || 0.00;
                        currentUserData.dailyWatchedAdsCount = currentUserData.dailyWatchedAdsCount || 0;
                        currentUserData.lastWatchDate = getTodayDate();
                        currentUserData.isNewUser = true; // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù…Ù†Ø·Ù‚ Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                        currentUserData.referredUsersCount = currentUserData.referredUsersCount || 0;
                        currentUserData.referralBonusEarned = currentUserData.referralBonusEarned || 0.00;
                        currentUserData.referredAdsWatched = currentUserData.referredAdsWatched || 0;
                        currentUserData.hasReceivedReferralBonusForThisUser = currentUserData.hasReceivedReferralBonusForThisUser || false; 

                        await setDoc(userDocRef, currentUserData);
                        console.log("initApp: ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙŠ Firestore.");
                    }

                } catch (error) {
                    console.error("initApp: Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨/ØªØ¹ÙŠÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firestore:", error);
                    showAdNotification("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. Ù‚Ø¯ ØªÙƒÙˆÙ† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù…Ø­Ø¯ÙˆØ¯Ø©. (Ø®Ø·Ø£ Firebase)");
                    // Ø¨Ø¯ÙŠÙ„ Ù„Ù€ localStorage (Ø£Ù‚Ù„ Ù…ÙˆØ«ÙˆÙ‚ÙŠØ© Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Mini Apps)
                    if (localStorage.getItem('userData')) {
                        currentUserData = JSON.parse(localStorage.getItem('userData'));
                        console.warn("initApp: Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ localStorage Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….");
                    }
                }
            } else {
                 console.warn("initApp: Ù„Ù… ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase. ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage ÙƒØ¨Ø¯ÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹).");
                 if (localStorage.getItem('userData')) {
                    currentUserData = JSON.parse(localStorage.getItem('userData'));
                 }
            }
            
            // 4. ØªØ­Ø¯ÙŠØ«Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·
            setLanguage(currentLanguage); // ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            updateUI(); // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©
            updateButtonStates(); // ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            generateReferralLink(); // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¢Ù† Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„/ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            console.log("initApp: ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙƒØ§Ù…Ù„Ø©.");
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUI() {
            watchedAdsEl.textContent = currentUserData.watchedAdsCount;
            earnedPointsEl.textContent = currentUserData.earnedPoints.toFixed(2);
            dailyWatchedAdsEl.textContent = `${currentUserData.dailyWatchedAdsCount} / ${DAILY_AD_LIMIT}`; 
            
            const progress = (currentUserData.watchedAdsCount % ADS_FOR_BONUS) / ADS_FOR_BONUS * 100;
            adsProgressEl.textContent = `${Math.round(progress)}%`;
            progressFillEl.style.width = `${progress}%`;
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ø¹Ù†Ø¯Ù…Ø§ ØªØªØºÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·
            earnedPointsEl.classList.remove('pulse');
            void earnedPointsEl.offsetWidth; // ØªØ´ØºÙŠÙ„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙÙ‚
            earnedPointsEl.classList.add('pulse');

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
            referredUsersCountEl.textContent = currentUserData.referredUsersCount;
            referralBonusEarnedEl.textContent = currentUserData.referralBonusEarned.toFixed(2);
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (currentUserData.telegramUserId) {
                userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', currentUserData.telegramUserId);
            } else if (firebaseCurrentUserId) { // Ø¨Ø¯ÙŠÙ„ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ± (Ù…Ø¹Ø±Ù Firebase Auth)
                 userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', firebaseCurrentUserId);
            } else {
                 userIdDisplayEl.textContent = translations[currentLanguage].user_id_display.replace('{userId}', "N/A"); // Ø£Ùˆ Ø¥Ø®ÙØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ±
            }


            updateButtonStates(); // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ±Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        }

        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
        async function saveUserDataToFirestore() {
            if (!isFirebaseInitialized || !firebaseCurrentUserId) {
                console.warn("saveUserDataToFirestore: Ù„Ù… ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase Ø£Ùˆ Ù„Ù… ÙŠØªÙ… Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­ÙØ¸ ÙÙŠ Firestore. Ø§Ù„Ø­ÙØ¸ ÙÙŠ localStorage.");
                localStorage.setItem('userData', JSON.stringify(currentUserData)); // Ø­ÙØ¸ Ø¨Ø¯ÙŠÙ„ (Ø£Ù‚Ù„ Ù…ÙˆØ«ÙˆÙ‚ÙŠØ© Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©)
                return;
            }
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹ØŒ ÙˆØ¥Ù„Ø§ ÙÙ…Ø¹Ø±Ù Firebase Auth
            const userIdToSave = currentUserData.telegramUserId || firebaseCurrentUserId;
            if (!userIdToSave) {
                 console.error("saveUserDataToFirestore: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØµØ§Ù„Ø­.");
                 return;
            }
            const userDocRef = doc(firebaseDb, `artifacts/${appId}/users/${userIdToSave}/appData/userData`);
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… `setDoc` Ù…Ø¹ `merge: true` Ù„Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
                await setDoc(userDocRef, currentUserData, { merge: true });
                console.log("saveUserDataToFirestore: ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù€:", userIdToSave);
            } catch (error) {
                console.error("saveUserDataToFirestore: Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore:", error);
                showAdNotification("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ.");
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø§Øª ØªÙ…ÙƒÙŠÙ†/ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        function updateButtonStates() {
            const limitReached = currentUserData.dailyWatchedAdsCount >= DAILY_AD_LIMIT;
            watchAdBtn.disabled = limitReached;
            autoAdBtn.disabled = limitReached; 
            
            if (limitReached) {
                // Ø¥Ø°Ø§ ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
                clearInterval(autoAdInterval);
                autoAdInterval = null; // Ù…Ø³Ø­ Ù…Ø¹Ø±Ù Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ
                stopAutoBtn.disabled = true; 
            } else {
                stopAutoBtn.disabled = !autoAdInterval; 
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Adsgram
        async function watchAd() {
            if (currentUserData.dailyWatchedAdsCount >= DAILY_AD_LIMIT) {
                showAdNotification(translations[currentLanguage].daily_limit_reached);
                return; 
            }

            showAdNotification(translations[currentLanguage].ad_loading);
            
            try {
                console.log("watchAd: Ù…Ø­Ø§ÙˆÙ„Ø© Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù† Adsgram...");
                if (typeof window.Adsgram !== 'undefined' && typeof window.Adsgram.init === 'function') {
                    await window.Adsgram.init({ blockId: "12082" }).show(); 
                    console.log("watchAd: ØªÙ… Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù† Adsgram Ø¨Ù†Ø¬Ø§Ø­."); 
                    
                    currentUserData.watchedAdsCount++;
                    currentUserData.earnedPoints += POINTS_PER_AD; 
                    currentUserData.dailyWatchedAdsCount++; 

                    // ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ù…Ø´Ø§Ù‡Ø¯Ø© Ù„Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                    currentUserData.lastWatchDate = getTodayDate();
                    
                    if (currentUserData.watchedAdsCount % ADS_FOR_BONUS === 0) {
                        currentUserData.earnedPoints += 1.00; // Ù†Ù‚Ø·Ø© Ø¥Ø¶Ø§ÙÙŠØ©
                    }

                    // Ù…Ù†Ø·Ù‚ Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„ ÙŠØ¤Ù‡Ù„ Ù…Ø­ÙŠÙ„Ù‡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø©
                    if (currentUserData.referrerId && currentUserData.isNewUser) { // ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ù„ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
                        currentUserData.referredAdsWatched = (currentUserData.referredAdsWatched || 0) + 1; // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø´Ø§Ù‡Ø¯Ù‡Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„

                        if (currentUserData.referredAdsWatched >= REFERRAL_BONUS_ADS_COUNT && !currentUserData.hasReceivedReferralBonusForThisUser) {
                            console.log(`watchAd: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„ ${currentUserData.telegramUserId} Ø´Ø§Ù‡Ø¯ ${REFERRAL_BONUS_ADS_COUNT} Ø¥Ø¹Ù„Ø§Ù†. Ù…Ù†Ø­ Ù…ÙƒØ§ÙØ£Ø© Ù„Ù„Ù…Ø­ÙŠÙ„.`);
                            
                            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙŠÙ„ ÙˆØªØ­Ø¯ÙŠØ« Ù†Ù‚Ø§Ø·Ù‡
                            // Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø«ÙŠÙ„ firebaseDb Ù…Ù† Ù†Ø·Ø§Ù‚ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                            const referrerDocRef = doc(firebaseDb, `artifacts/${appId}/users/${currentUserData.referrerId}/appData/userData`);
                            const referrerDocSnap = await getDoc(referrerDocRef);
                            
                            if (referrerDocSnap.exists()) {
                                const referrerData = referrerDocSnap.data();
                                const newReferrerPoints = (referrerData.earnedPoints || 0) + REFERRAL_BONUS_AMOUNT;
                                const newReferralBonusEarned = (referrerData.referralBonusEarned || 0) + REFERRAL_BONUS_AMOUNT;
                                
                                await updateDoc(referrerDocRef, {
                                    earnedPoints: newReferrerPoints,
                                    referralBonusEarned: newReferralBonusEarned
                                });
                                console.log(`watchAd: ØªÙ… Ù…Ù†Ø­ Ø§Ù„Ù…Ø­ÙŠÙ„ ${currentUserData.referrerId} ${REFERRAL_BONUS_AMOUNT} Ø¹Ù…Ù„Ø© pepe.`);
                                
                                // ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ØªÙ… Ø§Ø³ØªÙ„Ø§Ù…Ù‡Ø§ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„
                                currentUserData.hasReceivedReferralBonusForThisUser = true;
                                
                                // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ù„ÙŠÙ† Ù„Ù„Ù…Ø­ÙŠÙ„ Ø£ÙŠØ¶Ù‹Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                                if ((referrerData.referredUsersCount || 0) === (referrerDocSnap.data().referredUsersCount || 0)) { 
                                    await updateDoc(referrerDocRef, { referredUsersCount: (referrerData.referredUsersCount || 0) + 1 });
                                }
                            } else {
                                console.warn(`watchAd: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙŠÙ„ ${currentUserData.referrerId} ÙÙŠ Firestore.`);
                            }
                        }
                    }
                    
                    await saveUserDataToFirestore(); // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø¯Ø«Ø© ÙÙŠ Firestore
                    updateUI(); 
                    
                    showAdNotification(translations[currentLanguage].ad_completed_success);
                } else {
                    console.error("watchAd: Ø­Ø²Ù…Ø© Adsgram SDK ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø¹Ù†Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†.");
                    showAdNotification(translations[currentLanguage].ad_failed); 
                }

            } catch (error) {
                console.error("watchAd: ÙØ´Ù„ Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù† Adsgram Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£:", error);
                showAdNotification(translations[currentLanguage].ad_failed);
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ 
        function startAutoAds() {
            if (currentUserData.dailyWatchedAdsCount >= DAILY_AD_LIMIT) {
                showAdNotification(translations[currentLanguage].daily_limit_reached);
                return;
            }
            if (autoAdInterval) {
                clearInterval(autoAdInterval);
            }
            autoAdInterval = setInterval(watchAd, 30000); 
            autoAdBtn.disabled = true; 
            stopAutoBtn.disabled = false; 
            showAdNotification(translations[currentLanguage].auto_ads_started_notification);
        }
        
        function stopAutoAds() {
            clearInterval(autoAdInterval);
            autoAdInterval = null; 
            autoAdBtn.disabled = false; 
            stopAutoBtn.disabled = true; 
            showAdNotification(translations[currentLanguage].auto_ads_stopped_notification);
        }
        
        // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
        function showAdNotification(message) {
            adNotificationEl.textContent = message;
            adNotificationEl.style.display = 'block';
            
            setTimeout(() => {
                adNotificationEl.style.display = 'none';
            }, 3000);
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø³Ø­Ø¨
        function showWithdrawForm() {
            withdrawSectionEl.style.display = 'block';
        }

        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø³Ø­Ø¨
        async function withdrawPoints() {
            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            const paymentMethod = document.getElementById('payment-method').value; 
            const walletAddress = document.getElementById('wallet-address').value; 

            let minRequiredPoints;
            let methodName;

            if (paymentMethod === 'faucetpay') {
                minRequiredPoints = MIN_WITHDRAW_POINTS_FAUCETPAY;
                methodName = translations[currentLanguage].faucetpay_option;
            } else { 
                minRequiredPoints = MIN_WITHDRAW_POINTS;
                methodName = translations[currentLanguage].other_wallet_option;
            }

            if (isNaN(amount) || amount < minRequiredPoints) {
                let message = translations[currentLanguage].min_withdraw_message
                    .replace('{methodName}', methodName)
                    .replace('{minAmount}', minRequiredPoints);
                showTemporaryMessage(message, 'red');
                return;
            }

            if (amount > currentUserData.earnedPoints) {
                let message = translations[currentLanguage].insufficient_balance.replace('{earnedPoints}', currentUserData.earnedPoints.toFixed(2));
                showTemporaryMessage(message, 'red');
                return;
            }

            if (!walletAddress.trim()) { 
                showTemporaryMessage(translations[currentLanguage].enter_wallet_address, 'red');
                return;
            }

            // Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ø­Ù„ÙŠØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹
            currentUserData.earnedPoints -= amount;
            await saveUserDataToFirestore(); // Ø­ÙØ¸ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø­Ø¯Ø«Ø© ÙÙŠ Firestore
            updateUI(); 

            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„ÙØ¹Ù„ÙŠ
            let messageToAdmin = `New Withdrawal Request:\n`;
            if (currentUserData.telegramUsername && currentUserData.telegramUserId) {
                messageToAdmin += `User: @${currentUserData.telegramUsername} (ID: ${currentUserData.telegramUserId})\n`;
            } else {
                 messageToAdmin += `User ID: ${currentUserData.telegramUserId || firebaseCurrentUserId} (No Telegram Username/ID from Mini App)\n`;
            }
            messageToAdmin += `Amount: ${amount} pepe coins\nPayment Method: ${methodName}\nWallet Address: ${walletAddress}`;
            
            sendWithdrawRequestToAdmin(messageToAdmin); 

            showTemporaryMessage(translations[currentLanguage].withdrawal_success_message, 'green');

            document.getElementById('withdraw-amount').value = '';
            document.getElementById('wallet-address').value = '';
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ø¨Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
        function sendWithdrawRequestToAdmin(message) {
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${ADMIN_USER_ID}&text=${encodeURIComponent(message)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„');
                    } else {
                        console.error('ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…:', data.description || data);
                        let errorMessage = translations[currentLanguage].telegram_send_fail.replace('{error}', data.description || data);
                        showTemporaryMessage(errorMessage, 'red');
                    }
                })
                .catch(error => {
                    console.error('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ API ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…:', error);
                    let errorMessage = translations[currentLanguage].telegram_connect_error.replace('{error}', error.message);
                    showTemporaryMessage(errorMessage, 'red');
                });
        }

        // Ø£Ø¯Ø§Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¤Ù‚ØªØ©
        let messageTimeout;
        function showTemporaryMessage(msg, color) {
            withdrawStatusEl.textContent = msg;
            withdrawStatusEl.style.color = color;
            clearTimeout(messageTimeout);
            messageTimeout = setTimeout(() => {
                withdrawStatusEl.textContent = '';
            }, 5000); 
        }

        // ÙˆØ¸Ø§Ø¦Ù Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
        async function generateReferralLink() {
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† telegramUserIdØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ØªØ§Ø­Ù‹Ø§ Ø§Ù„Ø¢Ù† Ø¨Ø¹Ø¯ initAppØŒ ÙˆÙ„ÙƒÙ† Ù„Ù„Ø§Ø­ØªÙŠØ§Ø·
            if (!currentUserData.telegramUserId && window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
                currentUserData.telegramUserId = String(window.Telegram.WebApp.initDataUnsafe.user.id);
                currentUserData.telegramUsername = window.Telegram.WebApp.initDataUnsafe.user.username || window.Telegram.WebApp.initDataUnsafe.user.first_name || 'Anonymous';
                console.log("generateReferralLink: ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (ÙØ­Øµ Ù…ØªØ£Ø®Ø±):", currentUserData.telegramUserId);
            }

            const userIdForLink = currentUserData.telegramUserId; // Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ø¹Ø±Ù ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©

            if (userIdForLink) {
                const referralLink = `https://t.me/${BOT_USERNAME}?start=${userIdForLink}`;
                referralLinkInput.value = referralLink;
                console.log("generateReferralLink: ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©:", referralLink);
            } else {
                referralLinkInput.value = translations[currentLanguage].llm_insight_no_id; // Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù…Ø§Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ØªØ§Ø­
                console.warn("generateReferralLink: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… ØºÙŠØ± Ù…ØªØ§Ø­. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¹Ø±Ø¶ Ø®Ø§Ø±Ø¬ Ø³ÙŠØ§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØºØ±.");
            }
        }


        function copyReferralLink() {
            referralLinkInput.select();
            document.execCommand('copy');
            showAdNotification(translations[currentLanguage].copy_link_success);
        }

        // --- Ø¯Ø§Ù„Ø© Ø±Ø¤ÙŠØ© Ø£Ø¯Ø§Ø¡ LLM Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ---
        async function getAdInsight() {
            getInsightBtn.disabled = true; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨
            dogsInsightTextEl.textContent = translations[currentLanguage].llm_insight_loading;
            dogsInsightTextEl.classList.add('loading'); // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© ØªØ­Ù…ÙŠÙ„

            const prompt = `Ø£Ù†Ø§ Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù„ÙƒØ³Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©. Ù„Ù‚Ø¯ Ø´Ø§Ù‡Ø¯Øª ${currentUserData.watchedAdsCount} Ø¥Ø¹Ù„Ø§Ù†Ù‹Ø§ ÙˆØ±Ø¨Ø­Øª ${currentUserData.earnedPoints.toFixed(2)} Ø¹Ù…Ù„Ø© Pepe. Ø£Ø±Ø¬Ùˆ Ø£Ù† ØªÙ‚Ø¯Ù… Ù„ÙŠ Ø±Ø¤ÙŠØ© Ù…ÙˆØ¬Ø²Ø© ÙˆØªØ´Ø¬ÙŠØ¹ÙŠØ© Ø­ÙˆÙ„ Ø£Ø¯Ø§Ø¦ÙŠØŒ Ø£Ùˆ Ù†ØµÙŠØ­Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªØ­Ø³ÙŠÙ†Ù‡. ØªØ­Ø¯Ø« Ø¨Ù„Ù‡Ø¬Ø© ÙˆØ¯ÙˆØ¯Ø© ÙˆÙ…Ø´Ø¬Ø¹Ø©ØŒ ÙˆÙƒØ£Ù†Ùƒ Ù…Ø³Ø§Ø¹Ø¯ Ø´Ø®ØµÙŠ. Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù…Ø®ØªØµØ±Ø© ÙˆÙ…Ø¨Ø§Ø´Ø±Ø©ØŒ Ù„Ø§ ØªØ²ÙŠØ¯ Ø¹Ù† 50 ÙƒÙ„Ù…Ø©.`;

            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Gemini API
            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // Ø³ÙŠØªÙ… ØªÙˆÙÙŠØ±Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Canvas ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    dogsInsightTextEl.textContent = text;
                    dogsInsightTextEl.classList.remove('loading');
                } else {
                    dogsInsightTextEl.textContent = translations[currentLanguage].llm_insight_error;
                    dogsInsightTextEl.classList.remove('loading');
                    console.error("Ù‡ÙŠÙƒÙ„ Ø§Ø³ØªØ¬Ø§Ø¨Ø© LLM ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:", result);
                }
            } catch (error) {
                dogsInsightTextEl.textContent = translations[currentLanguage].llm_insight_error;
                dogsInsightTextEl.classList.remove('loading');
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Gemini API:", error);
            } finally {
                getInsightBtn.disabled = false; // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø²Ø±
            }
        }


        // ØªÙ‡ÙŠØ¦Ø© Ø­Ø²Ù…Ø© Telegram Mini App SDK (ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù‡Ø°Ù‡ Ø¯Ø§Ø¦Ù…Ø§Ù‹)
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand(); // ØªÙˆØ³ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØºØ± Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
            console.log("ØªÙ… ØªÙ‡ÙŠØ¦Ø© Telegram WebApp SDK.");
        } else {
            console.warn("Ù„Ù… ÙŠØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø­Ø²Ù…Ø© Telegram WebApp SDK. ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙƒØµÙØ­Ø© ÙˆÙŠØ¨ Ù…Ø³ØªÙ‚Ù„Ø©.");
        }

        // ØªÙ‡ÙŠØ¦Ø© Firebase ÙˆØ¨Ø¯Ø¡ Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ù‡Ø°Ø§ Ø§Ù„Ø¢Ù† ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø³Ù„ÙˆÙƒ window.onload)
        // ØªØ­Ù„ Ù‡Ø°Ù‡ Ø§Ù„ÙƒØªÙ„Ø© Ù…Ø­Ù„ window.onload Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ÙˆØªÙ‡ÙŠØ¦Ø© Firebase Ø§Ù„Ù…ÙƒØ±Ø±Ø©
        if (Object.keys(firebaseConfig).length > 0) {
            firebaseApp = initializeApp(firebaseConfig);
            firebaseDb = getFirestore(firebaseApp);
            firebaseAuth = getAuth(firebaseApp);
            isFirebaseInitialized = true;
            console.log("ØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase (ÙƒØªÙ„Ø© Ø³ÙƒØ±Ø¨Øª ÙˆØ§Ø­Ø¯Ø©).");

            onAuthStateChanged(firebaseAuth, async (user) => {
                if (user) {
                    firebaseCurrentUserId = user.uid;
                    console.log("ØªÙ… Ø­Ù„ Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Firebase: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„:", firebaseCurrentUserId);
                } else {
                    firebaseCurrentUserId = null;
                    console.log("ØªÙ… Ø­Ù„ Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Firebase: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
                    // Ø¨Ø¯ÙŠÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„ Ø¥Ø°Ø§ Ø£ØµØ¨Ø­Øª Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙØ§Ø±ØºØ© (Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ø¨Ø¯ÙˆÙ† ØªÙˆÙƒÙ†)
                    signInAnonymously(firebaseAuth).then(userCredential => {
                        firebaseCurrentUserId = userCredential.user.uid;
                        console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ù…Ù† Ø¨Ø¯ÙŠÙ„ onAuthStateChanged).", firebaseCurrentUserId);
                    }).catch(err => console.error("ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ø¨Ø¯ÙŠÙ„ onAuthStateChanged):", err));
                }
                // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ initApp Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ù…ØµØ§Ø¯Ù‚Ø© Firebase
                if (!appInitialized) { // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ initApp Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
                    initApp();
                }
            });

            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙˆÙƒÙ† Ù…Ø®ØµØµ Ø¥Ø°Ø§ ØªÙ… ØªÙˆÙÙŠØ±Ù‡ (Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª initData Ù„ØªØ·Ø¨ÙŠÙ‚ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØµØºØ±)
            // ÙŠØ­Ø¯Ø« Ù‡Ø°Ø§ Ù‚Ø¨Ù„ Ø£Ù† ÙŠØªÙ… ØªØ´ØºÙŠÙ„ onAuthStateChanged Ø¹Ø§Ø¯Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
            if (initialAuthToken) {
                signInWithCustomToken(firebaseAuth, initialAuthToken)
                    .then((userCredential) => {
                        console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙˆÙƒÙ† Ù…Ø®ØµØµ Ø¨Ù†Ø¬Ø§Ø­:", userCredential.user.uid);
                    })
                    .catch((error) => {
                        console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙˆÙƒÙ† Ù…Ø®ØµØµ:", error);
                        // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…Ø®ØµØµØŒ Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ ÙƒØ¨Ø¯ÙŠÙ„
                        signInAnonymously(firebaseAuth).then(userCredential => console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ø¨Ø¯ÙŠÙ„ Ù…Ù† Ø®Ø·Ø£ Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…Ø®ØµØµ).", userCredential.user.uid)).catch(err => console.error("ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ø¨Ø¯ÙŠÙ„ Ù…Ù† Ø®Ø·Ø£ Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…Ø®ØµØµ):", err));
                    });
            } else {
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ØªÙˆÙƒÙ† Ù…Ø®ØµØµØŒ Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„
                signInAnonymously(firebaseAuth)
                    .then((userCredential) => {
                        console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† Ù…Ø®ØµØµ).", userCredential.user.uid);
                    })
                    .catch((error) => {
                        console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¬Ù‡ÙˆÙ„ (Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† Ù…Ø®ØµØµ):", error);
                    });
            }
        } else {
            console.error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙ‡ÙŠØ¦Ø© Firebase. Ù„Ù† ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase. Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©.");
            isFirebaseInitialized = false;
            initApp(); // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ initApp Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase
        }

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙˆØ±Ø§Ù‹ØŒ Ø«Ù… Ø³ØªÙ‚ÙˆÙ… initApp Ø¨ØªØ­Ø³ÙŠÙ†Ù‡Ø§ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        setLanguage(currentLanguage);

    </script>
</body>
</html>
